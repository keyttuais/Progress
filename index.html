<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Results Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 2.5rem; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h2 { text-align: center; color: #1a1a1a; margin-bottom: 20px; }
        
        .controls { display: flex; justify-content: center; margin-bottom: 30px; }
        #searchBar { 
            width: 100%; max-width: 400px; padding: 12px 20px; 
            border: 2px solid #ddd; border-radius: 25px; outline: none;
            transition: border-color 0.3s; font-size: 16px;
        }
        #searchBar:focus { border-color: #3498db; }

        .chart-container { position: relative; height: 400px; width: 100%; margin-bottom: 40px; }

        /* List Styles */
        .results-list { list-style: none; padding: 0; margin-top: 20px; border-top: 1px solid #eee; }
        .list-item { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; border-bottom: 1px solid #eee; transition: background 0.2s;
        }
        .list-item:hover { background-color: #f9f9f9; }
        .test-info { flex-grow: 1; }
        .test-name { font-weight: bold; font-size: 1.1em; margin: 0; }
        .test-meta { font-size: 0.85em; color: #666; }
        .badge { 
            padding: 5px 12px; border-radius: 15px; font-size: 0.8em; 
            font-weight: bold; text-transform: uppercase; color: white;
        }
        .pass { background-color: #2ecc71; }
        .fail { background-color: #e74c3c; }
        .score-text { font-weight: bold; margin-left: 20px; min-width: 80px; text-align: right; }
    </style>
</head>
<body>

<div class="container">
    <h2>Academic Performance Dashboard</h2>
    
    <div class="controls">
        <input type="text" id="searchBar" placeholder="Search by test name..." onkeyup="updateView()">
    </div>

    <div class="chart-container">
        <canvas id="resultsChart"></canvas>
    </div>

    <div id="listView">
        <h3>Test Records</h3>
        <ul id="resultsList" class="results-list">
            </ul>
    </div>

        <div>
        <h3>Learnings</h3>
            <a href="learning.html">Go to Learning Hub</a> </div>
</div>

<script>
    // --- YOUR DATA SOURCE ---
    const allTestData = [
        { name: "Geography Practice", date: "2025-01-05", passing: 60, total: 90, obtained: 71 },
        { name: "CSAT Testseries (4022)", date: "2025-01-09", passing: 67, total: 200, obtained: 59 },
        { name: "CSAT Testseries (3728)", date: "2025-01-18", passing: 67, total: 200, obtained: 84.12 }
    ];

    let myChart;

    function renderChart(filteredData) {
        const ctx = document.getElementById('resultsChart').getContext('2d');
        if (myChart) { myChart.destroy(); }

        const labels = filteredData.map(test => `${test.name} (${test.date})`);
        const percentages = filteredData.map(test => (test.obtained / test.total) * 100);
        const backgroundColors = filteredData.map(test => test.obtained >= test.passing ? 'rgba(46, 204, 113, 0.8)' : 'rgba(231, 76, 60, 0.8)');
        const borderColors = filteredData.map(test => test.obtained >= test.passing ? 'rgb(39, 174, 96)' : 'rgb(192, 57, 43)');

        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Score Percentage (%)',
                    data: percentages,
                    backgroundColor: backgroundColors,
                    borderColor: borderColors,
                    borderWidth: 1,
                    borderRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { y: { beginAtZero: true, max: 100 } }
            }
        });
    }

    function renderList(filteredData) {
        const listContainer = document.getElementById('resultsList');
        listContainer.innerHTML = ''; // Clear existing

        filteredData.forEach(test => {
            const isPassed = test.obtained >= test.passing;
            const percentage = ((test.obtained / test.total) * 100).toFixed(1);
            
            const listItem = document.createElement('li');
            listItem.className = 'list-item';
            listItem.innerHTML = `
                <div class="test-info">
                    <p class="test-name">${test.name}</p>
                    <span class="test-meta">${test.date} | Passing: ${test.passing}</span>
                </div>
                <span class="badge ${isPassed ? 'pass' : 'fail'}">${isPassed ? 'Pass' : 'Fail'}</span>
                <span class="score-text">${test.obtained}/${test.total} (${percentage}%)</span>
            `;
            listContainer.appendChild(listItem);
        });
    }

    function updateView() {
        const searchTerm = document.getElementById('searchBar').value.toLowerCase();
        const filtered = allTestData.filter(test => 
            test.name.toLowerCase().includes(searchTerm)
        );
        renderChart(filtered);
        renderList(filtered);
    }

    // Initial load
    updateView();
</script>

</body>
</html>
